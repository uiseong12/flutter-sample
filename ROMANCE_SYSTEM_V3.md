# ROMANCE SYSTEM V3 — 감정선 강화 설계 반영안

## 0. 적용 목표
- 로맨스가 사건의 결과가 아니라 **사건의 원인**이 되도록 설계
- 호감도 숫자 중심에서 **관계 상태(Relationship State)** 중심으로 전환
- 30노드를 감정/정치/미스터리/경제가 함께 흔드는 구조로 재편

---

## 1. 핵심 원칙 적용
1) 사건-연애 상호의존
- 정치 선택이 감정 상태를 흔들고,
- 감정 상태가 정치 선택지(개방/잠금)를 바꾸도록 구현

2) 관계 상태 엔진 도입
- 각 캐릭터 상태: `낯섦 -> 호의 -> 신뢰 -> 흔들림 -> 결속 -> 동맹의 연인 -> 공동서약`
- 상태 전환은 아래 3요건 동시 충족:
  - 호감도 임계치
  - 핵심 플래그(감정 사건)
  - 정치 수치 조건

3) 감정선 파열 고정
- 각 권(3노드 묶음) 당 최소 1회:
  - 오해 / 희생 / 질투 / 배신 / 거리두기 / 화해

4) 선택의 비용
- 선택지는 항상 득실 동반
- “정답” 대신 “감정적 상처 비용”을 감당하도록 설계

5) 데이트 보조화
- 데이트는 확인/보상 레이어
- 메인 감정 진전은 메인 스토리 노드에서만 발생

---

## 2. 관계 상태 전환 표
| 상태 | 전환 최소 조건(예시) |
|---|---|
| 낯섦 -> 호의 | 호감도 20+, 해당 캐릭터 선택 2회 |
| 호의 -> 신뢰 | 호감도 40+, `public_support` 또는 `secret_protect` 플래그 |
| 신뢰 -> 흔들림 | 갈등 플래그(`lie_detected`/`order_over_me`) 발생 |
| 흔들림 -> 결속 | 화해 이벤트 성공 + 정치수치 1개 이상 50+ |
| 결속 -> 동맹의 연인 | 호감도 80+, 루트 확정(노드15) |
| 동맹의 연인 -> 공동서약 | 호감도 100 + 최종 정치조건 충족 |

---

## 3. 감정 플래그 표준화
- `publicly_supported_me`
- `protected_my_secret`
- `revealed_my_weakness`
- `lied_for_me`
- `chose_order_over_me`
- `trusted_me_without_proof`
- `demanded_evidence_against_me`

각 플래그는 노드 선택/재판 결과/데이트 특수 이벤트에서 획득.

---

## 4. 30노드 운용 규칙
- 1~10 생존 단계
- 11~20 권력 전환
- 21~30 왕권 결정

### 노드 템플릿(필수)
- 오프닝 상황
- 갈등 제시
- 선택지 2~3
- 수치 변화
- 감정 플래그 변화
- 다음 노드

### 치명 분기
- 노드 10, 20, 30은 반드시 생존/유배/사형/메인엔딩 판정 포함

---

## 5. 해금 시스템
해금 키 6종:
1) 노드 클리어
2) 관계 상태
3) 정치 수치
4) 증거 카드
5) 의상 태그
6) 해금 토큰

### 해금 조건 규칙
- 일반 콘텐츠: 3개 조건 중 2개 충족
- 고급 CG/고백씬: 3개 조건 모두 충족

---

## 6. IAP/광고 원칙 반영
### IAP
- 시즌패스(권 단위)
- 프리미엄 선택지 토큰
- 의상/CG/보이스 팩

### 광고
- 보상형 중심(노드 결과 후 / 알바 결과 후 / 구제권)
- 감정씬 보호 구간 광고 금지

감정씬 보호 구간:
- 고백
- 이별
- 화해
- 서약

---

## 7. 구현 우선순위 (개발 순서)
P0
- 관계 상태 엔진 + 플래그 저장
- 노드 조건형 선택지 잠금
- 30노드 JSON 데이터 로더

P1
- 재판 턴 시스템(의식 vs 증거)
- 캐릭터 POV 챕터 해금
- 엔딩 12종 조건 판정기

P2
- 시즌패스/토큰 연동
- 보이스/CG 팩 적용
- 2회차 기억 시스템

---

## 8. KPI (운영 지표)
- 15노드 도달률
- 루트 확정(노드15) 도달률
- 감정씬 이탈률
- 광고 시청 후 이탈률
- 엔딩 분포(12종)
